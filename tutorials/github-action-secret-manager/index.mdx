---
meta:
  title: Use GitHub action to fetch secrets from the Secret Manager
  description: Learn how to use the Scaleway GitHub action to fetch secrets and exposes them as environment variables in your workflow
content:
  h1: Use GitHub action to fetch secrets from the Secret Manager
  paragraph: Learn how to use the Scaleway GitHub action to fetch secrets and exposes them as environment variables in your workflow
tags: secret-management github-action continuous-integration
categories:
  - secret-manager
  - security-identity
dates:
  validation: 2023-05-24
  posted: 2023-05-24
---

## GitHub Actions - Overview

[GitHub Actions](https://github.com/features/actions) makes it easy to automate all your software workflows, now with world-class CI/CD. Build, test, and deploy your code right from GitHub. Make code reviews, branch management, and issue triaging work the way you want.

In this tutorial you will lear how to use the [Scaleway Secret Manager GitHub Action](https://github.com/scaleway/action-scw-secret) in your GitHub Actions workflow to retrieve your secrets stored in the Scaleway Secret Manager and expose them as environment variables.

Often times when doing Continuous Integration/Continuous Deployment, you need to access to secrets to log in to a Docker registry, push some code changes, call some APIs, ...

A good practice is to use a [Secret Manager](/identity-and-access-management/secret-manager/quickstart/) to store your secrets, securely, in one place. When doing that you have to copy/paste your secrets and put them in your CI which duplicates the secrets and leads to descynchronization with your source of truth. Here comes the GitHub action.

## Preparing your GitHub repository

<Macro id="iam-requirements" />

<Message type="requirement">
  - You have created an [API key](/docs/identity-and-access-management/iam/how-to/create-api-keys/)
</Messgae>

You will need to create the following secrets in your GitHub repository. Follow the steps bellow:

- `SCW_ACCESS_KEY`: your API access key
- `SCW_SECRET_KEY`: your API secret key
- `SCW_DEFAULT_ORGANIZATION_ID`: your organization ID
- `SCW_DEFAULT_PROJECT_ID`: the project ID where you have your secrets

1. Navigate to **Settings** > **Secrets and Variables** > **Actions** of your GitHub Repository
2. Click **New repository secret** and fill the **Name** and **Secret** fields.
3. Click **Add secret** to submit.
4. Repeat until you have all the secrets

GitHub secrets are immutables, if you want to update the value, you need to delete the current secret and create a new one.

<Lightbox src="repository-secrets.webp" alt="repository secrets" />

## Use the GitHub action in your workflow

Suppose you already have a workflow defined in `.github/workflows/test.yml`, you can now use the action by adding the following code:

```yaml
[...]
    steps:
[...]
      - uses: scaleway/action-scw-secret@v0
        with:
          secret-names: |
            my-github-secret
          access-key: ${{ secrets.SCW_ACCESS_KEY }}
          secret-key: ${{ secrets.SCW_SECRET_KEY }}
          default-project-id: ${{ secrets.SCW_DEFAULT_PROJECT_ID }}
          default-organization-id: ${{ secrets.SCW_DEFAULT_ORGANIZATION_ID }}
[...]
```

This will tell the GitHub action to access the **latest** version of your secret called `my-github-secret` and will expose its value as the environment variable `MY_GITHUB_SECRET`. You are now able to use this environment variable in the following steps of the job like this:

```yaml
[...]
      - run: echo "Successfully retrieve 'my-github-secret' with value $MY_GITHUB_SECRET"
```

The value will be shown as `***` in the logs of your action to prevent leak of the secret value.

## Resources

Here the full content of the workflow described above:

```yaml
name: Scaleway get secrets action test
on: [push]
jobs:
  test-scaleway-get-secrets:
    runs-on: ubuntu-latest
    steps:
      - uses: scaleway/action-scw-secret@v0
        with:
          secret-names: |
            my-github-secret
          access-key: ${{ secrets.SCW_ACCESS_KEY }}
          secret-key: ${{ secrets.SCW_SECRET_KEY }}
          default-project-id: ${{ secrets.SCW_DEFAULT_PROJECT_ID }}
          default-organization-id: ${{ secrets.SCW_DEFAULT_ORGANIZATION_ID }}
      - run: echo "Successfully retrieve 'my-github-secret' with value $MY_GITHUB_SECRET"
```
